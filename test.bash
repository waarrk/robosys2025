#!/bin/bash -xv
# SPDX-FileCopyrightText: 2025 Yusaku Washio <s22c1704za@s.chibakoudai.jp>
# SPDX-License-Identifier: BSD-3-Clause

ng () {
    echo "${1}行目が違うよ"
    res=1
}

res=0


#========================================
# 正常系 1
# 50音順ソート：基本の並び替え
#========================================
input="山田
あいざわ
たなか
いのうえ
さとう"

expected="あいざわ
いのうえ
さとう
たなか
山田"

a=$(echo "$input" | ./kana-sort)

[ "$a" = "$expected" ] || ng "$LINENO"


#========================================
# 正常系 2
# 前後の空白を含む行の処理
# trim されてソートされるはず
#========================================
a=$(printf "  さとう\n  あいざわ \n" | ./kana-sort)
expected="あいざわ
さとう"

[ "$a" = "$expected" ] || ng "$LINENO"


#========================================
# 異常系 1
# 空行
#========================================
a=$(echo "" | ./kana-sort)
[ "$?" = 1 ] || ng "$LINENO"
[ "$a" = "" ] || ng "$LINENO"


#========================================
# 異常系 2
# 空白だけの行
#========================================
a=$(printf "   \n" | ./kana-sort)
[ "$?" = 1 ] || ng "$LINENO"
[ "$a" = "" ] || ng "$LINENO"


#========================================
# 異常系 3
# 無効行が混じる場合
#========================================
a=$(printf "山田\n\n佐藤\n" | ./kana-sort)
[ "$?" = 1 ] || ng "$LINENO"
[ "$a" = "" ] || ng "$LINENO"


[ "$res" = 0 ] && echo OK

exit $res
